<?xml version="1.0" encoding="utf-8"?>
<search> 
  
    
    <entry>
      <title>第一个Scrapy项目</title>
      <link href="/FirstScrapyproject.html"/>
      <url>/FirstScrapyproject.html</url>
      <content type="html"><![CDATA[<h2 id="一个Scrapy项目"><a href="#一个Scrapy项目" class="headerlink" title="一个Scrapy项目"></a>一个Scrapy项目</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ scrapy startproject projectname</span><br><span class="line">$ cd projectname</span><br><span class="line">$ tree</span><br></pre></td></tr></table></figure><h3 id="声明item"><a href="#声明item" class="headerlink" title="声明item"></a>声明item</h3><p>列出需要爬取的字段列表,再去修改scrapy为我们创建的ProjectsItem类,就变的很容易,修改projectname/item.py文件:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">from scrapy import Item, Field</span><br><span class="line"></span><br><span class="line">class ProjectnameItem(Item):</span><br><span class="line">title=Field()</span><br><span class="line">url=field()</span><br></pre></td></tr></table></figure></p><h3 id="编写爬虫"><a href="#编写爬虫" class="headerlink" title="编写爬虫"></a>编写爬虫</h3><p>通常,我们会为每个网站或网站的一部分(如果网站非常大的话)创建一个爬虫,爬虫代码实现了完整的<strong>UR<sup>2</sup>IM</strong>流程.<br><em>什么时候用爬虫,什么时候用项目呢？项目是由若干爬虫组成的，如果用很多网站，并且需要从中抽取相同类型的Item，比如：房产，那么这些网站可以用同一个项目，并且为每个源/网站使用一个爬虫。反之，如果要处理图书和房产两个不同的源时，则应该使用不同的项目。</em><br>可以在文本编辑器中从头开始创建一个爬虫，不过，为了减少输入，更好的方法是使用<code>scrapy genspider</code>命令，<br>下面两种写法都可以<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">#第一种写法</span><br><span class="line">import scrapy</span><br><span class="line">class BasicSpider(scrapy.Spider)</span><br><span class="line">name=&quot;basic&quot; #爬虫的name必须是唯一值</span><br><span class="line">start_urls=&#123;</span><br><span class="line">&apos;http://web.com&apos;,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">def parse(self,response):</span><br><span class="line">pass</span><br><span class="line"># 第二种写法</span><br><span class="line">import scrapy</span><br><span class="line">class BasicSpider(scrapy.Spider)</span><br><span class="line">name=&quot;basic&quot; #爬虫的name必须是唯一值</span><br><span class="line">start_urls=&#123;</span><br><span class="line">&apos;http://example.com&apos;,</span><br><span class="line">&#125;</span><br><span class="line">def start_request(self):</span><br><span class="line">urls=&#123;</span><br><span class="line">&apos;http://example.com&apos;,</span><br><span class="line">&#125;</span><br><span class="line">for url in urls:</span><br><span class="line">scrapy.Request(url,callback=self.parse)</span><br><span class="line"># callback为空时默认为self.parse</span><br><span class="line"></span><br><span class="line">def parse(self,response):</span><br><span class="line">pass</span><br></pre></td></tr></table></figure></p><p>import 语句能让我们使用Scrapy框架中已有的类，<br>下面是扩展自scrapy.Spider的BasicSpider类的定义。通过“扩展”的方式，尽管我们没有写任何代码，但实际上已经继承了Scrapy框架中的Spider类的相当一部分功能。这样，就可以值额外编写少量代码，就能获得一个完整运行的爬虫了。</p><h3 id="填充item"><a href="#填充item" class="headerlink" title="填充item"></a>填充item</h3><p>首先需要引入ProjectnameItem类。如前所述，它在projectname目录的items.py文件中，也就是projectname.items模块中，在basic.py中引如该模块.<br><code>from projectname.items import ProjectnameItems</code><br>然后需要实例化并返回一个对象.这非常简单.在parse方法中,可以通过添加<code>items=ProjectnameItem()</code>语句创建一个新的item,然后可以按如下的方式为其字段分配表达式.<br><code>item[&quot;title&#39;]=response.xpath().extract()</code><br>最后通过<code>return items</code>返回items<br>通过命令行<code>scrapy crawl baisc</code>运行爬虫</p><h3 id="保存文件"><a href="#保存文件" class="headerlink" title="保存文件"></a>保存文件</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ scrapy crawl basic -o items.json</span><br><span class="line">$ scrapy crawl basic -o items.csv</span><br><span class="line">$ scrapy crawl basic -o itemsjl</span><br><span class="line">scrapy crawl basic -o items.jl</span><br></pre></td></tr></table></figure><p>我们不需要编写任何额外的代码,,就可以保存为这些不同的格式.<br>csv和xml非常流行因为类似微软Excel的程序可以直接打开它们.<br>JSON文件在网上非常流行,原因是它们富有表现力而且与js的关系非常的密切,<br>JSON与JSON Line(jl)格式的轻微不同是,囧on文件是在大数组中储存json对象的,而.jl文件则是每行包含一个JSON对象,所以可以被更高效的读取.</p><blockquote><p>将你生成的文件保存到文件系统之外的地方也很容易,<br><code>$ scrapy crawl basic -o ftp://user:pass@ftp.scrapybook.com/item.json</code><br><code>$ scrapy crawl basic -o s3://aws_key:aws_secret@s3.scrapybook.com/item.json</code><br>可以直接使用scrapy parse<br><code>scrapy parse --spider=basic http://example.com</code></p></blockquote><h3 id="清理–item装载器与管理字段"><a href="#清理–item装载器与管理字段" class="headerlink" title="清理–item装载器与管理字段"></a>清理–item装载器与管理字段</h3><p>首先,我们使用一个强大的工具类–ItemLoader,以代替那些繁杂的extract()和xpath()操作.</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">from scrapy.Spider</span><br><span class="line">from scrapy.loader import ItemLoader</span><br><span class="line">from myproject.items import Product</span><br><span class="line"></span><br><span class="line">def parse(self, response):</span><br><span class="line">    l = ItemLoader(item=Product(), response=response)</span><br><span class="line">    l.add_xpath(&apos;name&apos;, &apos;//div[@class=&quot;product_name&quot;]&apos;)</span><br><span class="line">    l.add_xpath(&apos;name&apos;, &apos;//div[@class=&quot;product_title&quot;]&apos;)</span><br><span class="line">    l.add_xpath(&apos;price&apos;, &apos;//p[@id=&quot;price&quot;]&apos;)</span><br><span class="line">    l.add_css(&apos;stock&apos;, &apos;p#stock]&apos;)</span><br><span class="line">    l.add_value(&apos;last_updated&apos;, &apos;today&apos;) # you can also use literal values</span><br><span class="line">    return l.load_item()</span><br></pre></td></tr></table></figure><p>文档地址:<a href="https://doc.scrapy.org/en/latest/topics/loaders.html" target="_blank" rel="noopener">https://doc.scrapy.org/en/latest/topics/loaders.html</a><br>这种写法不止是在视觉上更加舒服，它还非常明确地声明了我们意图去做的事情，而不会将其与实现细节混淆起来。使得代码具有更好的可维护性以及自描述性。<br>Itemloaders通过不同的处理类（processors）传递XPath/CSS表达式的值。处理器是一个快速而又简单的函数。<br>处理器的一个例子就是Join()。该处理其可以把多个结果连在一起。<br>另一个有意思的处理器是MapCompose(),使用该处理器,你可以使用任意的Python函数或函数链，以实现复杂的功能，</p><h3 id="创建contract"><a href="#创建contract" class="headerlink" title="创建contract"></a>创建contract</h3><p>contract有点像为爬虫设计的单元测试。他可以让你快速知道哪里有运行异常。<br>contract包含在紧挨着函数名的注释中，并以@开头。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&apos;&apos;&apos;This Function parses a properties page.</span><br><span class="line">      contracks</span><br><span class="line">      @url http://www.bookschina.com/kinder/27000000/</span><br><span class="line">      @returns items 1</span><br><span class="line">      @scrapes title sellPrice description publisher author image_urls</span><br><span class="line">      @scrapes url project spider server date</span><br><span class="line">   &apos;&apos;&apos;</span><br></pre></td></tr></table></figure></p><h3 id="抽取更多的URL"><a href="#抽取更多的URL" class="headerlink" title="抽取更多的URL"></a>抽取更多的URL</h3><ul><li>横向——从一个索引页到另一个索引页</li><li>纵向——从一个索引页到详情页面<br>我们将前者称为<strong>水平爬取</strong>，后者称为<strong>垂直爬取</strong><h4 id="使用爬虫实现双向爬取"><a href="#使用爬虫实现双向爬取" class="headerlink" title="使用爬虫实现双向爬取"></a>使用爬虫实现双向爬取</h4>现在我们编写一个新的parse（）方法，来实现水平和垂直两种抓取方式</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">def parse(self,response):</span><br><span class="line">#Get the next index URLs and yield Request</span><br><span class="line">next_selector=response.xpath(&apos;//*[contains(@class,&quot;next&quot;)]/@href)</span><br><span class="line">for url in next_selector.extract():</span><br><span class="line">yield scrapy.Request(response.urljoin(url))</span><br><span class="line"></span><br><span class="line">#Get item URLs and yield Request</span><br><span class="line">Item_selector=response.xpath(&apos;//*[contains(@itemprop,&quot;url&quot;)]/@href)</span><br><span class="line">for url in Item_selector:</span><br><span class="line">scrapy.Request(response.urljoin(url),callback=self.parse_item)</span><br></pre></td></tr></table></figure><p>我们现在已经准备好运行该爬虫了。不过要让该爬虫以当前的方式运行的话，则会抓取网站完整的几万个页面。为了避免运行时间过长，课通过命令行参数：<code>-s CLOSESPIDER_ITEMCOUTTN=90</code>告知爬虫在爬取指定数量（90）的Item后停止运行。</p><h4 id="使用CrawlSpider-实现双向爬取"><a href="#使用CrawlSpider-实现双向爬取" class="headerlink" title="使用CrawlSpider 实现双向爬取"></a>使用CrawlSpider 实现双向爬取</h4><p>如果感觉上面的双向爬取有些冗长，则说你确实发现了关键的问题。Scrapy尝试简化此类通用的情况，以使编码更加简单。最简单的实现同样结果的方式是使用CrawlSpider，这是一个能够更容易实现这种爬虫的类。为了实现它，我们需要使用genspider命令，并设置-t crawl参数，以使用crawl爬虫模板创建一个爬虫。<br><code>$ scrapy genspider -t crawl easy web.com</code><br>现在，爬虫文件easy.py包含如下内容：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"># -*- coding: utf-8 -*-</span><br><span class="line">import scrapy</span><br><span class="line">from scrapy.linkextractors import LinkExtractor</span><br><span class="line">from scrapy.spiders import CrawlSpider, Rule</span><br><span class="line"></span><br><span class="line">class EasySpider(CrawlSpider):</span><br><span class="line">    name = &apos;easy&apos;</span><br><span class="line">    allowed_domains = [&apos;web.com&apos;]</span><br><span class="line">    start_urls = [&apos;http://web.com/&apos;]</span><br><span class="line"></span><br><span class="line">    rules = (</span><br><span class="line">        Rule(LinkExtractor(allow=r&apos;Items/&apos;), callback=&apos;parse_item&apos;, follow=True),</span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line">    def parse_item(self, response):</span><br><span class="line">        i = &#123;&#125;</span><br><span class="line">        #i[&apos;domain_id&apos;] = response.xpath(&apos;//input[@id=&quot;sid&quot;]/@value&apos;).extract()</span><br><span class="line">        #i[&apos;name&apos;] = response.xpath(&apos;//div[@id=&quot;name&quot;]&apos;).extract()</span><br><span class="line">        #i[&apos;description&apos;] = response.xpath(&apos;//div[@id=&quot;description&quot;]&apos;).extract()</span><br><span class="line">        return i</span><br></pre></td></tr></table></figure></p><p>当你阅读这段自动生成的代码时,你会发现它和之前的爬虫有一些相似,不过在此处的生命==类声明中,会发现爬虫时继承自CrawlSpider,而不再时Spider.CrawlSpider提供了以个使用rules变量实现的parse()方法,这和我们之前例子中手工实现的功能一致.<br>现在,我们要把start_urls 设置成第一个索引页,并使用我们之前的实现替换预定义的parse_item()方法.这次我们将不再需要实现任何parse()方法.我们将预定义的rules变量替换为两条规则,即水平抓取和垂直抓取.<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ruls = (</span><br><span class="line">Rule(LinkExtractor(restrict_xpath=&apos;//*[contains(@class,&quot;next&quot;)]&apos;)),</span><br><span class="line">Rule(LinkExtractor(restrict_xpath=&apos;//*[@itemprop=&quot;url&quot;]&apos;),</span><br><span class="line">callback=&apos;parse_item&apos;)</span><br><span class="line">)</span><br></pre></td></tr></table></figure></p><p>这两条规则使用的是和我们之前手工实现的示例中相同的XPath表达式,不过这里没有了a或是href的限制.顾名思义,LinkExtractor正是专门用于抽取链接的,因此在默认情况下,他们会去查找a(及area)href属性.你可以通过设置LinkExtractor()的tags和attrs参数来进行自定义.<br>需要注意的是,回调参数目前包含的是回调方法名称的字符串(比图’parse_item’),而不是方法引用,如Request(self.parse_Item).最后,除非设置了callback参数,否则Rule将跟踪已经抽取的URL,也就是说他将会扫描目标页面以获得额外的链接并跟踪它们,.如果设置课callback,Rule将不会跟踪目标页面的链接.如果你希望它跟踪链接,应当在callback方法中使用return或yield返回它们,或者将Rule()的follow参数设置为True.</p>]]></content>
      
      <categories>
          
          <category> Python </category>
          
          <category> 爬虫 </category>
          
          <category> Scrapy </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Python </tag>
            
            <tag> python </tag>
            
            <tag> 爬虫，Scrapy </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Python爬取小说《心里罪城市之光》</title>
      <link href="/Python%E7%88%AC%E5%8F%96%E5%B0%8F%E8%AF%B4%E3%80%8A%E5%BF%83%E7%90%86%E7%BD%AA%E5%9F%8E%E5%B8%82%E4%B9%8B%E5%85%89%E3%80%8B.html"/>
      <url>/Python%E7%88%AC%E5%8F%96%E5%B0%8F%E8%AF%B4%E3%80%8A%E5%BF%83%E7%90%86%E7%BD%AA%E5%9F%8E%E5%B8%82%E4%B9%8B%E5%85%89%E3%80%8B.html</url>
      <content type="html"><![CDATA[<p><img src="http://upload-images.jianshu.io/upload_images/5804969-4083038808332dd5.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="爬取结果"></p><blockquote><p>我们选择努努小说进行小说的爬取<br><a href="http://www.kanunu8.com/book4/10571/" target="_blank" rel="noopener">http://www.kanunu8.com/book4/10571/</a><br><img src="http://upload-images.jianshu.io/upload_images/5804969-5a07f2b416b2bf1d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p><ul><li>先写代码将目录爬下来，添加到一个列表中，比较简单，在此就不多说<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">#爬取结果</span><br><span class="line">title=[&apos;序 往事&apos;,</span><br><span class="line"> &apos;第一章 和自己赛跑的人&apos;,</span><br><span class="line"> &apos;第二章 求婚&apos;,</span><br><span class="line"> &apos;第三章 报应&apos;,</span><br><span class="line"> &apos;第四章 足迹&apos;,</span><br><span class="line"> &apos;第五章 回忆的灰烬&apos;,</span><br><span class="line"> &apos;第六章 子宫&apos;,</span><br><span class="line"> &apos;第七章 雨夜寻踪&apos;,</span><br><span class="line"> &apos;第八章 噩梦&apos;,</span><br><span class="line"> &apos;第九章 对手&apos;,</span><br><span class="line"> &apos;第十章 思路&apos;,</span><br><span class="line"> &apos;第十一章 同态复仇&apos;,</span><br><span class="line"> &apos;第十二章 他的样子&apos;,</span><br><span class="line"> &apos;第十三章 地下室&apos;,</span><br><span class="line"> &apos;第十四章 似曾相识&apos;,</span><br><span class="line"> &apos;第十五章 城市之光&apos;,</span><br><span class="line"> &apos;第十六章 死期&apos;,</span><br><span class="line"> &apos;第十七章 公决&apos;,</span><br><span class="line"> &apos;第十八章 掌印&apos;,</span><br><span class="line"> &apos;第十九章 老宅&apos;,</span><br><span class="line"> &apos;第二十章 身份&apos;,</span><br><span class="line"> &apos;第二十一章 轮回&apos;,</span><br><span class="line"> &apos;第二十二章 杀手养成&apos;,</span><br><span class="line"> &apos;第二十三章 最爱&apos;,</span><br><span class="line"> &apos;第二十四章 忽略&apos;,</span><br><span class="line"> &apos;第二十五章 夺走&apos;,</span><br><span class="line"> &apos;第二十六章 熄灭&apos;,</span><br><span class="line"> &apos;第二十七章 死者的证言&apos;,</span><br><span class="line"> &apos;尾声 我想你要走了&apos;]</span><br></pre></td></tr></table></figure></li></ul></blockquote><ul><li><p>打开几章小说，观察URL规律<br>~<a href="http://www.kanunu8.com/book4/10571/186030.html" target="_blank" rel="noopener">http://www.kanunu8.com/book4/10571/186030.html</a>~<br>~<a href="http://www.kanunu8.com/book4/10571/186031.html" target="_blank" rel="noopener">http://www.kanunu8.com/book4/10571/186031.html</a>~</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">i=30</span><br><span class="line">while i&lt;59:</span><br><span class="line">  url=&apos;http://www.kanunu8.com/book4/10571/1860&apos;+str(i)+&apos;.html&apos;</span><br><span class="line">  i+=1</span><br></pre></td></tr></table></figure></li><li><p>用循环打开并爬取每个网页（每个章节）<br>使用框架打开网页：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">try:</span><br><span class="line">       r=requests.get(url,timeout=30)</span><br><span class="line">       r.raise_for_status() #判断网页返回的状态码是否为200</span><br><span class="line">       r.encoding=r.apparent_encoding</span><br><span class="line">   except:</span><br><span class="line">       return &apos;产生异常&apos;</span><br></pre></td></tr></table></figure></li><li><p>由于网页结构比较简单，使用Beautiful Soup解析网页内容</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">soup=BeautifulSoup(r.text,&apos;lxml&apos;)</span><br><span class="line">tag=soup.p.contents</span><br></pre></td></tr></table></figure></li><li><p>将解析的小说内容写入到文件</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">path=&apos;g:/&apos;+title[(i-30)]+&apos;.txt&apos;</span><br><span class="line"> with open(path,&apos;w&apos;) as f:</span><br><span class="line">        #f.write(&apos;第 %s 章\r\n\r\n&apos;%(i-31))</span><br><span class="line">        for a in tag:</span><br><span class="line">            if type(a) is bs4.element.NavigableString:</span><br><span class="line">                f.write(str(a.string[6:])+&apos;\n&apos;)</span><br><span class="line">                print(a.string[6:])</span><br><span class="line">        f.close()</span><br></pre></td></tr></table></figure></li></ul><hr><p>###完整代码：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"># -*- coding: utf-8 -*-</span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line">Comments  parsing </span><br><span class="line"> </span><br><span class="line">@author: NiceBlueChai</span><br><span class="line">&quot;&quot;&quot; </span><br><span class="line">import requests</span><br><span class="line">import bs4</span><br><span class="line"></span><br><span class="line">from bs4 import BeautifulSoup</span><br><span class="line">import time</span><br><span class="line">def getHTMLText(url):</span><br><span class="line">    try:</span><br><span class="line">        r=requests.get(url,timeout=30)</span><br><span class="line">        r.raise_for_status()</span><br><span class="line">        r.encoding=r.apparent_encoding</span><br><span class="line">        return r.text</span><br><span class="line">    except:</span><br><span class="line">        return &apos;产生异常&apos;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">title=[&apos;序 往事&apos;,</span><br><span class="line"> &apos;第一章 和自己赛跑的人&apos;,</span><br><span class="line"> &apos;第二章 求婚&apos;,</span><br><span class="line"> &apos;第三章 报应&apos;,</span><br><span class="line"> &apos;第四章 足迹&apos;,</span><br><span class="line"> &apos;第五章 回忆的灰烬&apos;,</span><br><span class="line"> &apos;第六章 子宫&apos;,</span><br><span class="line"> &apos;第七章 雨夜寻踪&apos;,</span><br><span class="line"> &apos;第八章 噩梦&apos;,</span><br><span class="line"> &apos;第九章 对手&apos;,</span><br><span class="line"> &apos;第十章 思路&apos;,</span><br><span class="line"> &apos;第十一章 同态复仇&apos;,</span><br><span class="line"> &apos;第十二章 他的样子&apos;,</span><br><span class="line"> &apos;第十三章 地下室&apos;,</span><br><span class="line"> &apos;第十四章 似曾相识&apos;,</span><br><span class="line"> &apos;第十五章 城市之光&apos;,</span><br><span class="line"> &apos;第十六章 死期&apos;,</span><br><span class="line"> &apos;第十七章 公决&apos;,</span><br><span class="line"> &apos;第十八章 掌印&apos;,</span><br><span class="line"> &apos;第十九章 老宅&apos;,</span><br><span class="line"> &apos;第二十章 身份&apos;,</span><br><span class="line"> &apos;第二十一章 轮回&apos;,</span><br><span class="line"> &apos;第二十二章 杀手养成&apos;,</span><br><span class="line"> &apos;第二十三章 最爱&apos;,</span><br><span class="line"> &apos;第二十四章 忽略&apos;,</span><br><span class="line"> &apos;第二十五章 夺走&apos;,</span><br><span class="line"> &apos;第二十六章 熄灭&apos;,</span><br><span class="line"> &apos;第二十七章 死者的证言&apos;,</span><br><span class="line"> &apos;尾声 我想你要走了&apos;]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">for i in range(30,58):</span><br><span class="line">    </span><br><span class="line">    path=&apos;g:/&apos;+title[(i-30)]+&apos;.txt&apos;</span><br><span class="line">    url=&apos;http://www.kanunu8.com/book4/10571/1860&apos;+str(i)+&apos;.html&apos;</span><br><span class="line">    try:</span><br><span class="line">        r=requests.get(url,timeout=30)</span><br><span class="line">        r.raise_for_status()</span><br><span class="line">        r.encoding=&apos;GBK&apos;</span><br><span class="line">    except:</span><br><span class="line">        print(&apos;异常！！！&apos;)</span><br><span class="line">    soup=BeautifulSoup(r.text,&apos;lxml&apos;)</span><br><span class="line">    tag=soup.p.contents</span><br><span class="line">    with open(path,&apos;w&apos;) as f:</span><br><span class="line">        #f.write(&apos;第 %s 章\r\n\r\n&apos;%(i-31))</span><br><span class="line">        for a in tag:</span><br><span class="line">            if type(a) is bs4.element.NavigableString:</span><br><span class="line">                f.write(str(a.string[6:])+&apos;\n&apos;)</span><br><span class="line">                print(a.string[6:])</span><br><span class="line">        f.close()</span><br><span class="line">    </span><br><span class="line">    time.sleep(1)</span><br></pre></td></tr></table></figure></p><hr><p><strong>❤️我的目标是：someday，即便你花钱看我的文章，也会觉得心满意足</strong></p><hr><p><img src="http://upload-images.jianshu.io/upload_images/5804969-64ca917b7b70f881.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1080/q/50" alt=""></p>]]></content>
      
      <categories>
          
          <category> Python </category>
          
          <category> 爬虫 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Python </tag>
            
            <tag> python </tag>
            
            <tag> 爬虫 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>在Windows-Server上搭建Web服务器</title>
      <link href="/%E5%9C%A8Windows-Sever-%E4%B8%8A%E6%90%AD%E5%BB%BAWeb%E6%9C%8D%E5%8A%A1%E5%99%A8.html"/>
      <url>/%E5%9C%A8Windows-Sever-%E4%B8%8A%E6%90%AD%E5%BB%BAWeb%E6%9C%8D%E5%8A%A1%E5%99%A8.html</url>
      <content type="html"><![CDATA[<h1 id="两种方法："><a href="#两种方法：" class="headerlink" title="两种方法："></a>两种方法：</h1><ul><li>安装IIS</li><li>安装Apache</li></ul><hr><h3 id="安装IIS作为web服务器"><a href="#安装IIS作为web服务器" class="headerlink" title="安装IIS作为web服务器"></a>安装IIS作为web服务器</h3><p><strong>要求</strong></p><ul><li>安装WindowsSever系统（可使用虚拟机，要开启NAT服务）</li><li>将IP地址设置为静态的</li><li>计算机可以访问Internet<br>+开放80端口，可用cmd命令<code>netstat -an</code>查看</li></ul><p><strong>注意</strong>：虚拟机上本地链接中<strong>网关</strong>要与虚拟机<strong>编辑</strong>-&gt;<strong>NAT</strong>服务中一致</p><p><strong>在WindowsSever上安装IIS</strong><br>服务器管理 -&gt; 添加角色，按步骤安装<br>安装后应有以下服务启动<br><img src="http://upload-images.jianshu.io/upload_images/5804969-fc18198046031c8c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p><p>打开后有一个默认网站</p><h3 id="安装DNS服务，搭建DNS服务器"><a href="#安装DNS服务，搭建DNS服务器" class="headerlink" title="安装DNS服务，搭建DNS服务器"></a>安装DNS服务，搭建DNS服务器</h3><p>添加正向查找区域<br>访问时将本地连接属性中IPv4属性的DNS该为DNS服务器的ipv4地址<br>使用域名访问时便可以解析到指定IP地址</p><h2 id="限制网站宽带和连接数量"><a href="#限制网站宽带和连接数量" class="headerlink" title="限制网站宽带和连接数量"></a>限制网站宽带和连接数量</h2><p>一个服务器上可以放许多网站，而服务器的带宽是一定的<br>为了保证服务器的性能与正常工作、每个网站的正常访问、每个用户的体验，需要对每个网站的带宽和网站并发连接数进行限制</p><hr><p>右击 管理网站 高级设置</p><p><img src="http://upload-images.jianshu.io/upload_images/5804969-b1da620b91b0bbf7.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p><h2 id="网站重定向"><a href="#网站重定向" class="headerlink" title="网站重定向"></a>网站重定向</h2><p>简单的说，自动跳转<br>网站与网页都可以重定向<br>可以重定向到其他网站，也可以重定向到本站的其他页面和文件</p><ul><li><strong>定向到media</strong></li></ul><p><img src="http://upload-images.jianshu.io/upload_images/5804969-f325c98308203c5d.gif?imageMogr2/auto-orient/strip" alt=""></p><ul><li><strong>定向到百度</strong><br><img src="http://upload-images.jianshu.io/upload_images/5804969-b69cba6c03d1733d.gif?imageMogr2/auto-orient/strip" alt=""></li></ul><p><img src="http://upload-images.jianshu.io/upload_images/5804969-9a940979dee015fd.gif?imageMogr2/auto-orient/strip" alt=""></p><h2 id="网站访问日志"><a href="#网站访问日志" class="headerlink" title="网站访问日志"></a>网站访问日志</h2><p><img src="http://upload-images.jianshu.io/upload_images/5804969-9202874f96889f3b.gif?imageMogr2/auto-orient/strip" alt="日志.gif"><br>每次访问网站都会在日志中记录，可以在选项中选择记录项，记录的日志默认保存在…\inetpub\logs\LogFiles目录下</p><p><img src="http://upload-images.jianshu.io/upload_images/5804969-4759d5e03c35bc7a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="日志.png"></p><p><img src="http://upload-images.jianshu.io/upload_images/5804969-af04c763abcdb4e8.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="日志文件"></p><h2 id="网站标识"><a href="#网站标识" class="headerlink" title="网站标识"></a>网站标识</h2><p><strong>可在一个服务器上创建多个网站，区分他们的方法，使用网站标识：</strong></p><ol><li>web服务器网卡绑定多的IP地址，每个网站使用不同的IP地址，太奢侈，因为公网IP资源紧张，不采用此方法</li><li>通过端口访问不同的网站，80端口为默认端口</li><li>绑定域名，通过域名访问网站</li></ol><h2 id="配置网站支持文件下载"><a href="#配置网站支持文件下载" class="headerlink" title="配置网站支持文件下载"></a>配置网站支持文件下载</h2><p>仅需要80端口<br>在网站物理目录下新建一个media文件夹，放一些东西，访问该目录</p><p><img src="http://upload-images.jianshu.io/upload_images/5804969-96c743ad90c724ab.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p><h6 id="要访问文件需要开启目录浏览"><a href="#要访问文件需要开启目录浏览" class="headerlink" title="要访问文件需要开启目录浏览"></a>要访问文件需要开启<strong>目录浏览</strong></h6><p><img src="http://upload-images.jianshu.io/upload_images/5804969-fa1ca94d0bc64834.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p><h6 id="再次访问"><a href="#再次访问" class="headerlink" title="再次访问"></a>再次访问</h6><p><img src="http://upload-images.jianshu.io/upload_images/5804969-6de420cf1652dc90.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p><h6 id="要想让别人下载各种拓展名（格式）的文件需要配置MIME类型"><a href="#要想让别人下载各种拓展名（格式）的文件需要配置MIME类型" class="headerlink" title="要想让别人下载各种拓展名（格式）的文件需要配置MIME类型"></a>要想让别人下载各种拓展名（格式）的文件需要配置<strong><a href="https://baike.baidu.com/item/MIME/2900607?fr=aladdin" target="_blank" rel="noopener">MIME</a>类型</strong></h6><p><img src="http://upload-images.jianshu.io/upload_images/5804969-d3021aec61253852.gif?imageMogr2/auto-orient/strip" alt="mime.gif"></p><h2 id="保持会话连接"><a href="#保持会话连接" class="headerlink" title="保持会话连接"></a>保持会话连接</h2><p><img src="http://upload-images.jianshu.io/upload_images/5804969-21217b612a872013.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="保持会话"><br>网站使用TCP协议，每次连接建立会话需要三次握手，为了提高效率，一次建立会话后连接保持一定时间，不许要每次请求都进行三次握手浪费时间，访问量较大时保持连接很耗费服务器性能，取消连接超时则耗费带宽，根据情况选择。</p><h2 id="MC地址与ARP欺骗"><a href="#MC地址与ARP欺骗" class="headerlink" title="MC地址与ARP欺骗"></a>MC地址与ARP欺骗</h2><p>网络执法官（控制本网段计算机的通信）、P2P终结者（控制本网段计算机上网带宽）这两个（流氓）软件通过arp欺骗进行“上网管理”，还可以通过arp欺骗捕获本网段计算机的账号密码，<strong>arp协议已在IPv6中停用</strong></p><h5 id="判断是否被arp欺骗"><a href="#判断是否被arp欺骗" class="headerlink" title="判断是否被arp欺骗"></a><strong>判断是否被arp欺骗</strong></h5><p>当网络连接正常，但无法上网，而同网段其他计算机可以上网，可能是计算机受到攻击中病毒了，可通过命令行cmd查看<strong>arp -a</strong>,对比同网段其他计算机DNS缓存的MC地址，若不一样就是被ARP欺骗了。</p><h5 id="解决方法"><a href="#解决方法" class="headerlink" title="解决方法"></a>解决方法</h5><ul><li>可通过命令行指令<strong>arp -s [ip] [mc]</strong>来设置dns服务器mc地址</li><li>可以通过修复网卡（修复网络连接）清除缓存的MC地址</li></ul><p><img src="http://upload-images.jianshu.io/upload_images/5804969-2eceb27ba3be18af.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p><h2 id="注：只有使用IPv4协议并且使用-自动获取IP、自动获取DNS的计算机会遭到ARP欺骗"><a href="#注：只有使用IPv4协议并且使用-自动获取IP、自动获取DNS的计算机会遭到ARP欺骗" class="headerlink" title="注：只有使用IPv4协议并且使用**自动获取IP、自动获取DNS的计算机会遭到ARP欺骗"></a>注：只有使用IPv4协议并且使用**自动获取IP、自动获取DNS的计算机会遭到ARP欺骗</h2><p><strong>❤️</strong></p><hr><p><img src="http://upload-images.jianshu.io/upload_images/5804969-64ca917b7b70f881.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1080/q/50" alt=""></p>]]></content>
      
      <categories>
          
          <category> 服务器 </category>
          
          <category> Web服务器 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Windows-Server </tag>
            
            <tag> 搭建Web服务器 </tag>
            
            <tag> 服务器 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Qt-QLabe显示文字和图片</title>
      <link href="/Qt-QLabe%E6%98%BE%E7%A4%BA%E6%96%87%E5%AD%97%E5%92%8C%E5%9B%BE%E7%89%87.html"/>
      <url>/Qt-QLabe%E6%98%BE%E7%A4%BA%E6%96%87%E5%AD%97%E5%92%8C%E5%9B%BE%E7%89%87.html</url>
      <content type="html"><![CDATA[<p><strong><a href="http://doc.qt.io/qt-5/qlabel.html" target="_blank" rel="noopener">QLabe Class参考文档</a></strong> </p><p><img src="http://upload-images.jianshu.io/upload_images/5804969-e44b6926fca028b0.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="示例图片.png"></p><blockquote><p>文字与图片的显示格式实际上是用<strong>Qt StyleSheet</strong>（样式表）设置的与css样式中的差不多</p></blockquote><ul><li>对齐方式</li></ul><p><img src="http://upload-images.jianshu.io/upload_images/5804969-993d3520aaeb4965.PNG?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="对齐方式.PNG"></p><ul><li>是否换行</li></ul><p><img src="http://upload-images.jianshu.io/upload_images/5804969-aa49526c35f8a0bd.PNG?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="是否换行.PNG"></p><ul><li>设置边框</li></ul><p><img src="http://upload-images.jianshu.io/upload_images/5804969-0e54eafadb013e0d.PNG?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="边框.PNG"></p><h3 id="显示LOGO-显示图片"><a href="#显示LOGO-显示图片" class="headerlink" title="显示LOGO(显示图片)"></a>显示LOGO(显示图片)</h3><ul><li><h5 id="添加图片资源"><a href="#添加图片资源" class="headerlink" title="添加图片资源"></a>添加图片资源</h5><p><img src="http://upload-images.jianshu.io/upload_images/5804969-53f30ccc964e31d8.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="添加图片资源.png"></p></li><li><h5 id="添加一个Labe用来显示图片"><a href="#添加一个Labe用来显示图片" class="headerlink" title="添加一个Labe用来显示图片"></a>添加一个Labe用来显示图片</h5></li></ul><p><img src="http://upload-images.jianshu.io/upload_images/5804969-2cce2fa18c90ff62.PNG?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="边框.PNG"></p><p><img src="http://upload-images.jianshu.io/upload_images/5804969-8fa48d881fabf796.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p><h2 id="❤️"><a href="#❤️" class="headerlink" title="❤️"></a><strong>❤️</strong></h2><p><img src="http://upload-images.jianshu.io/upload_images/5804969-64ca917b7b70f881.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1080/q/50" alt=""></p>]]></content>
      
      <categories>
          
          <category> Qt </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Qt </tag>
            
            <tag> QLabe </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>定时器Timer</title>
      <link href="/%E5%AE%9A%E6%97%B6%E5%99%A8Timer.html"/>
      <url>/%E5%AE%9A%E6%97%B6%E5%99%A8Timer.html</url>
      <content type="html"><![CDATA[<h3 id="定时器用于实现定时操作，如："><a href="#定时器用于实现定时操作，如：" class="headerlink" title="定时器用于实现定时操作，如："></a>定时器用于实现定时操作，如：</h3><ul><li>每三分钟保存一次</li><li>每500毫秒闪烁一次</li><li>每1秒刷新一次界面<blockquote><p>新建Timer</p></blockquote></li></ul><h4 id="1-重写timeEvent-函数"><a href="#1-重写timeEvent-函数" class="headerlink" title="(1) 重写timeEvent()函数"></a>(1) 重写<strong>timeEvent()</strong>函数</h4><p>virtual void timerEvent ( QTimerEvent * event );<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">// 定时器处理函数</span><br><span class="line">void Test8_2A::timerEvent ( QTimerEvent * event )</span><br><span class="line">&#123;</span><br><span class="line">// 可以有多个定时器，每个的定时器有不同的</span><br><span class="line">处理</span><br><span class="line">  if(event‐&gt;timerId() == m_timerId)</span><br><span class="line">  &#123;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h4 id="2-启动定时器，指定时间间隔"><a href="#2-启动定时器，指定时间间隔" class="headerlink" title="(2) 启动定时器，指定时间间隔"></a>(2) 启动定时器，指定时间间隔</h4><p>m_timerId=startTime(500);</p><blockquote><p>例子：实现一个文字时钟，显示系统当前时间 </p></blockquote><p><img src="http://upload-images.jianshu.io/upload_images/5804969-f12b9f703f74f0a5.gif?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">Timer_Event::Timer_Event(QWidget *parent)</span><br><span class="line">: QMainWindow(parent)</span><br><span class="line">&#123;</span><br><span class="line">ui.setupUi(this);</span><br><span class="line">m_timerId = startTimer(1000);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">void Timer_Event::timerEvent(QTimerEvent *event)</span><br><span class="line">&#123;</span><br><span class="line">if (event-&gt;timerId()==m_timerId)</span><br><span class="line">&#123;</span><br><span class="line">QTime now = QTime::currentTime();</span><br><span class="line">QString text = now.toString(&quot;HH:mm:ss ap&quot;);</span><br><span class="line">ui.labelTime-&gt;setText(text);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><p><strong>❤️</strong></p><hr><p><img src="http://upload-images.jianshu.io/upload_images/5804969-64ca917b7b70f881.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1080/q/50" alt=""></p>]]></content>
      
      <categories>
          
          <category> Qt </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Qt </tag>
            
            <tag> Timer </tag>
            
            <tag> 定时器 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Qt-使用工作线程</title>
      <link href="/%E4%BD%BF%E7%94%A8%E5%B7%A5%E4%BD%9C%E7%BA%BF%E7%A8%8B.html"/>
      <url>/%E4%BD%BF%E7%94%A8%E5%B7%A5%E4%BD%9C%E7%BA%BF%E7%A8%8B.html</url>
      <content type="html"><![CDATA[<p>comments: false&gt;<strong>在Qt里，线程相关的类：</strong><br> QThread 线程<br> QMutex  互斥锁<br>QSemaphore 信号量</p><blockquote><p>“工作线程”:就是一个普通的线程,区别于”界面线程”<br>当一个事件处理可能需要较长时间,就创建一个工作线程处理它,以避免界面卡死.</p></blockquote><p></p><h3 href="#a1" id="a1"><strong>步骤:</strong></h3><br>(1) 启动一个工作线程<br>(2) 显示一个进度条或对等待话框<br>(3) 启动一个定时器,定时查询工作线程的进度和状态,在其完成之后,填满进度条、结束等待.<p></p><h4 id="创建线程"><a href="#创建线程" class="headerlink" title="创建线程"></a><strong>创建线程</strong></h4><p>派生一个线程类<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">class MyThread : public QThread</span><br><span class="line">&#123;</span><br><span class="line">Q_OBJECT</span><br><span class="line">public:</span><br><span class="line">MyThread(QObject *parent);</span><br><span class="line">~MyThread();</span><br><span class="line">void run();   // 线程的入口函数</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></p><blockquote><p>添加一些成员函数，用于查询任务的状态和进度 :<br>状态：int GetStatus();<br>已完成(1)<br>正在进行(0)<br>发生错误，已终止(‐1)<br>进度：int GetProgress();<br>0‐100</p></blockquote><h4 id="启动线程"><a href="#启动线程" class="headerlink" title="启动线程"></a><strong>启动线程</strong></h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">MyTask* m_task = new MyTask();</span><br><span class="line">m_task‐&gt;start();</span><br></pre></td></tr></table></figure><h4 id="回收线程"><a href="#回收线程" class="headerlink" title="回收线程"></a><strong>回收线程</strong></h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">m_task-&gt;wait();</span><br></pre></td></tr></table></figure>]]></content>
      
      <categories>
          
          <category> Qt </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Qt </tag>
            
            <tag> 线程 </tag>
            
            <tag> 工作线程 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Qt的信号和槽</title>
      <link href="/Qt%E7%9A%84%E4%BF%A1%E5%8F%B7%E5%92%8C%E6%A7%BD.html"/>
      <url>/Qt%E7%9A%84%E4%BF%A1%E5%8F%B7%E5%92%8C%E6%A7%BD.html</url>
      <content type="html"><![CDATA[<blockquote><p>信号和槽是Qt特有的信息传输驱动机制，是Qt程序设计中的重要基础，它可以让程序员在互不相干的对象之间建立联系。<br>  <strong>槽</strong>本质上是类的成员函数，其参数可以是任意类型，它与普通的C++成员函数几乎没有区别，它可以是虚函数；也可以被重载函数；可以是公有的、保护的或私有的，也可以被其它C++成员函数调用，和普通的类成员函数唯一不同的是：槽还可以和信号连接在一起，每当和槽连接的信号被发射时，就会自动调用这个槽。</p></blockquote><p><strong>connect()语法形式如下：</strong><br><code>connect(sender,SIGNAL(signal),receiver,SLOT(slot));</code><br>这里的sender是发送信号的对象的指针，receiver是包含槽的对象的指针，signal是被发送的信号，slot是接受信号的槽，他们都是不带参数的函数名。SIGNAL()宏和SLOT()宏会把他们的参数转换成相应的字符串。对于信号和槽，还具有以下特点。</p><h3 id="1-一个信号可以连接多个槽"><a href="#1-一个信号可以连接多个槽" class="headerlink" title="1.一个信号可以连接多个槽"></a>1.一个信号可以连接多个槽</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">connect(sender,SIGNAL(signal),receiver,SLOT(slotA));</span><br><span class="line">connect(sender,SIGNAL(signal),receiver,SLOT(slotB));</span><br></pre></td></tr></table></figure><p>当这一信号发射时，会以不确定的顺序一个接一个的调用这个信号连接的所有槽</p><h3 id="2-多个信号可以连接同一个槽"><a href="#2-多个信号可以连接同一个槽" class="headerlink" title="2.多个信号可以连接同一个槽"></a>2.多个信号可以连接同一个槽</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">connect(sender,SIGNAL(signalA),receiver,SLOT(slot));</span><br><span class="line">connect(sender,SIGNAL(signalB),receiver,SLOT(slot));</span><br></pre></td></tr></table></figure><p>无论哪个信号被发射，这个槽都会被调用</p><h3 id="3-一个信号可以连接另外一个信号"><a href="#3-一个信号可以连接另外一个信号" class="headerlink" title="3.一个信号可以连接另外一个信号"></a>3.一个信号可以连接另外一个信号</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">connect(sender,SIGNAL(signalA),receiver,SIGNAL(signalB));</span><br></pre></td></tr></table></figure><p>当信号A发射时，也会发射与它相连的信号B</p><h3 id="４-信号、槽之间的连接可以被移除"><a href="#４-信号、槽之间的连接可以被移除" class="headerlink" title="４.信号、槽之间的连接可以被移除"></a>４.信号、槽之间的连接可以被移除</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">disconnect(sender,SIGNAL(signal),receiver,SLOT(slot));</span><br></pre></td></tr></table></figure><p>因为删除对象时，Qt会自动移除和这个对象相关的所有连接，所以这个语法很少用到。</p><blockquote><p>除此之外，要把信号成功连接到槽（或者连接到另一个信号），还应该注意，相连接的信号和槽必须具有相同顺序相同类型的参数，如果信号的参数比它所连接的槽的参数多，那么多余的参数将被简单的忽略掉。例如：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">connect(sender,SIGNAL(rawCommandReply(int,const QString &amp;)),</span><br><span class="line">receiver,SIGNAL(processReply(int , const QString &amp;)));</span><br></pre></td></tr></table></figure></p></blockquote><p>如果参数类型不匹配，或者信号或槽不存在，尽管应用程序调试构建可能会通过，但Qt会在运行时发出警告。<br>如果信号和槽的名字中包含了参数名，也会发生错误警告</p><blockquote><p>实际上这种机制是在QObject中实现的，这表明信号和槽并不仅仅局限于GUI编程中，实际上这种机制可以用于任何QObject的子类中，</p></blockquote><h3 id="在普通的类中使用信号和槽机制"><a href="#在普通的类中使用信号和槽机制" class="headerlink" title="在普通的类中使用信号和槽机制"></a><strong>在普通的类中使用信号和槽机制</strong></h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">Class Circle:public QObject</span><br><span class="line">&#123;</span><br><span class="line">Q_ONJECT</span><br><span class="line">public:</span><br><span class="line">Circle()&#123;CircleRadius=0;&#125;</span><br><span class="line">int Radius()&#123;return CircleRadius;&#125;</span><br><span class="line">public slots:</span><br><span class="line">void setRadius(int newRadius);</span><br><span class="line">signals:</span><br><span class="line">void radiusChanged(int newRadius);</span><br><span class="line">private:</span><br><span class="line">int circleRadius;</span><br><span class="line">&#125;;</span><br><span class="line">void Circle::setRadius(int newRadius)</span><br><span class="line">&#123;</span><br><span class="line">if(newRadius!=circleRadius)</span><br><span class="line">&#123;</span><br><span class="line">circleRadius=newRadius;</span><br><span class="line">emit radiusChanged(circleRadius);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><p style="font-weight:700"><br>来看一下，setRadius()槽是如何工作的。<br>仔细阅读会发现只有在newRadius不等于circleRadius的时候，才会发射radiusChanged()信号。这样既可以确保信号和槽连接又不会导致无限循环。</p><h2 id=""><a href="#" class="headerlink" title=""></a><p></p></h2><p><strong>❤️我的目标是：someday，即便你花钱看我的文章，也会觉得心满意足</strong></p><hr><p><img src="http://upload-images.jianshu.io/upload_images/5804969-64ca917b7b70f881.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1080/q/50" alt=""></p>]]></content>
      
      <categories>
          
          <category> Qt </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Qt </tag>
            
            <tag> 信号和槽 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Qt-非模式对话框</title>
      <link href="/Qt-%E9%9D%9E%E6%A8%A1%E5%BC%8F%E5%AF%B9%E8%AF%9D%E6%A1%86.html"/>
      <url>/Qt-%E9%9D%9E%E6%A8%A1%E5%BC%8F%E5%AF%B9%E8%AF%9D%E6%A1%86.html</url>
      <content type="html"><![CDATA[<h4 id="应用实例-搜索框"><a href="#应用实例-搜索框" class="headerlink" title="应用实例:搜索框"></a>应用实例:<strong>搜索框</strong></h4><h5 id="创建一个Widget对象，作为主窗体的成员变量"><a href="#创建一个Widget对象，作为主窗体的成员变量" class="headerlink" title="创建一个Widget对象，作为主窗体的成员变量"></a>创建一个<strong>Widget</strong>对象，作为主窗体的成员变量</h5><p><code>SearchWindow* m_SearchWin;</code><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">m_SearchWin=new SearchWindow(this);</span><br><span class="line">m_SearchWin-&gt;setWindowFlags(Qt::Window);</span><br></pre></td></tr></table></figure></p><h5 id="在用户执行搜索菜单时显示此窗口"><a href="#在用户执行搜索菜单时显示此窗口" class="headerlink" title="在用户执行搜索菜单时显示此窗口"></a>在用户执行搜索菜单时显示此窗口</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">int Text_7_4A::ShowSearch() &#123;</span><br><span class="line">m_searchWin-&gt;show();</span><br><span class="line"></span><br><span class="line">return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="在搜索窗口内有动作时，在主窗口中相应此动作需要将搜索类的ui成员变为public类型"><a href="#在搜索窗口内有动作时，在主窗口中相应此动作需要将搜索类的ui成员变为public类型" class="headerlink" title="在搜索窗口内有动作时，在主窗口中相应此动作需要将搜索类的ui成员变为public类型"></a>在搜索窗口内有动作时，在主窗口中相应此动作需要将搜索类的<strong>ui</strong>成员变为<strong>public</strong>类型</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">//响应小窗口内的动作</span><br><span class="line">connect(m_searchWin-&gt;ui.btnStartSearch, SIGNAL(clicked()), this, SLOT(OnStartSearch()) );</span><br></pre></td></tr></table></figure><p>//响应小窗口内的动作<br>    connect(m_searchWin-&gt;ui.btnStartSearch, SIGNAL(clicked()), this, SLOT(OnStartSearch()) );</p><p>笔芯<strong>❤️</strong></p><hr><p><img src="http://upload-images.jianshu.io/upload_images/5804969-64ca917b7b70f881.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1080/q/50" alt=""></p>]]></content>
      
      <categories>
          
          <category> Qt </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Qt </tag>
            
            <tag> 对话框 </tag>
            
            <tag> 非模式对话框 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Qt-模式对话框</title>
      <link href="/Qt-%E6%A8%A1%E5%BC%8F%E5%AF%B9%E8%AF%9D%E6%A1%86.html"/>
      <url>/Qt-%E6%A8%A1%E5%BC%8F%E5%AF%B9%E8%AF%9D%E6%A1%86.html</url>
      <content type="html"><![CDATA[<p><strong> <a href="http://www.kuqin.com/qtdocument/qdialog.html" target="_blank" rel="noopener">QDialog类参考</a><br><img src="http://upload-images.jianshu.io/upload_images/5804969-e1e885c6d8a93620.gif?imageMogr2/auto-orient/strip" alt="演示"></strong></p><p>对话框：用于提示用户输入</p><p>####对话框分两种：</p><h5 id="（1）模式对话框Modal"><a href="#（1）模式对话框Modal" class="headerlink" title="（1）模式对话框Modal"></a>（1）模式对话框Modal</h5><p>背景界面卡住，用户必须完成对话框输入，关闭<br>对话框之后，才能回到背景界面</p><h5 id="（2）非模式对话框Non‐Modal"><a href="#（2）非模式对话框Non‐Modal" class="headerlink" title="（2）非模式对话框Non‐Modal"></a>（2）非模式对话框Non‐Modal</h5><p>背景界面可以活动。</p><h4 id="任务："><a href="#任务：" class="headerlink" title="任务："></a><strong>任务：</strong></h4><p><strong>点登录按钮，弹出对话框提示用户输入。用户点“确认”或“取消”后，回到主界面。</strong></p><h5 id="1-新建对话框，布局"><a href="#1-新建对话框，布局" class="headerlink" title="(1)新建对话框，布局"></a>(1)新建对话框，布局</h5><h5 id="2-点确定时，accept-对话框返回"><a href="#2-点确定时，accept-对话框返回" class="headerlink" title="(2)点确定时，accept() 对话框返回"></a>(2)点确定时，accept() 对话框返回</h5><p>点取消时，reject()对话框返回<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">int LoginDlg::OnbtnOK() &#123;</span><br><span class="line">    //取得用户的输入</span><br><span class="line">m_user = ui.TextUser-&gt;text();</span><br><span class="line">m_password = ui.TextPassword-&gt;text();</span><br><span class="line"></span><br><span class="line">accept();//关闭对话框，并返回Accepted</span><br><span class="line">return 0;</span><br><span class="line">&#125;</span><br><span class="line">int LoginDlg::OnbtnCancel() &#123;</span><br><span class="line">//用户取消</span><br><span class="line">reject();</span><br><span class="line">return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h5 id="3-运行对话框-exec-，注意exec-的返回值"><a href="#3-运行对话框-exec-，注意exec-的返回值" class="headerlink" title="(3) 运行对话框 exec()，注意exec()的返回值"></a>(3) 运行对话框 exec()，注意exec()的返回值</h5><h5 id="4-取得用户输入"><a href="#4-取得用户输入" class="headerlink" title="(4) 取得用户输入"></a>(4) 取得用户输入</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">int QtLog_01::OnbtnOK_1() &#123;</span><br><span class="line">//使用对话框</span><br><span class="line">LoginDlg dlg;</span><br><span class="line">int ret=dlg.exec();//对话框显示，程序阻塞</span><br><span class="line">if (ret == QDialog::Accepted) &#123;</span><br><span class="line">qDebug()&lt;&lt; dlg.m_user &lt;&lt; dlg.m_password;//调试输出</span><br><span class="line">&#125;</span><br><span class="line">else &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><a href="https://share.weiyun.com/787e93746981807c38941d725b7414c4" target="_blank" rel="noopener">源码下载</a></p><h2 id="❤️"><a href="#❤️" class="headerlink" title="❤️"></a><p style="font-size:10rem; text-align:center">❤️</p></h2>]]></content>
      
      <categories>
          
          <category> Qt </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Qt </tag>
            
            <tag> 对话框 </tag>
            
            <tag> 模式对话框 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Qt-文件对话框</title>
      <link href="/Qt-%E6%96%87%E4%BB%B6%E5%AF%B9%E8%AF%9D%E6%A1%86.html"/>
      <url>/Qt-%E6%96%87%E4%BB%B6%E5%AF%B9%E8%AF%9D%E6%A1%86.html</url>
      <content type="html"><![CDATA[<h4 id="QFileDialog类参考"><a href="#QFileDialog类参考" class="headerlink" title="QFileDialog类参考"></a><a href="http://www.kuqin.com/qtdocument/qfiledialog.html" target="_blank" rel="noopener">QFileDialog类参考</a></h4><p><img src="http://upload-images.jianshu.io/upload_images/5804969-c39dca41fcb1fc55.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="示例演示"></p><h4 id="选择打开文件"><a href="#选择打开文件" class="headerlink" title="选择打开文件"></a>选择打开文件</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">int QtFile_01::OnClickbtnOpen() &#123;</span><br><span class="line">//选择要打开的文件</span><br><span class="line">QString fileName = QFileDialog::getOpenFileName(this,</span><br><span class="line">GBK::ToUnicode(&quot;Open File打开文件&quot;),//标题</span><br><span class="line">&quot;&quot;,</span><br><span class="line">tr(&quot;(*)&quot;));//限制文件类型</span><br><span class="line"></span><br><span class="line">//为空时表明用户取消了操作</span><br><span class="line">if (fileName.length() &gt; 0) &#123;</span><br><span class="line">qDebug() &lt;&lt; fileName;</span><br><span class="line">//Unicode(QString) -&gt; GBK(string)</span><br><span class="line">string gbk_name = GBK::FromUnicode(fileName);</span><br><span class="line"></span><br><span class="line">//打开文件,读取内容</span><br><span class="line">FILE* fp;</span><br><span class="line">fopen_s(&amp;fp, gbk_name.c_str(), &quot;rb&quot;);</span><br><span class="line"></span><br><span class="line">//获取文件大小</span><br><span class="line">fseek(fp, 0, SEEK_END);</span><br><span class="line">int filesize = ftell(fp);</span><br><span class="line"></span><br><span class="line">//读取内容</span><br><span class="line">fseek(fp, 0, SEEK_SET);</span><br><span class="line">char* buf = new char[filesize + 1];</span><br><span class="line">int n = fread(buf,1, filesize, fp);</span><br><span class="line">if (n &gt; 0) &#123;</span><br><span class="line">buf[n] = 0;</span><br><span class="line">//显示文本</span><br><span class="line">ui.plainTextEdit-&gt;setPlainText(GBK::ToUnicode(buf));</span><br><span class="line">&#125;</span><br><span class="line">//释放内存，关闭界面</span><br><span class="line">delete[]buf;</span><br><span class="line">fclose(fp);</span><br><span class="line">&#125;</span><br><span class="line">return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="保存文件"><a href="#保存文件" class="headerlink" title="保存文件"></a>保存文件</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">int QtFile_01::OnClickbtnSave() </span><br><span class="line">&#123;</span><br><span class="line">//选择要保存的位置</span><br><span class="line">QString fileName = QFileDialog::getSaveFileName(this, //父窗口</span><br><span class="line">GBK::ToUnicode(&quot;保存文件&quot;),</span><br><span class="line">&quot;/&quot;);</span><br><span class="line"></span><br><span class="line">//若为空表明用户取消了操作</span><br><span class="line">if (fileName.length() &gt; 0) </span><br><span class="line">&#123;</span><br><span class="line">//获取文本框中的内容</span><br><span class="line">QString text = ui.plainTextEdit-&gt;toPlainText();</span><br><span class="line">//Unicode(QString) -&gt; GBK(string)</span><br><span class="line">string gbk_name = GBK::FromUnicode(fileName);</span><br><span class="line">string gbk_text = GBK::FromUnicode(text);</span><br><span class="line"></span><br><span class="line">//打开文件</span><br><span class="line">FILE* fp;</span><br><span class="line">fopen_s(&amp;fp, gbk_name.c_str(), &quot;wb&quot;);</span><br><span class="line">//写入文件</span><br><span class="line">fwrite(gbk_text.c_str(), 1, gbk_text.length(), fp);</span><br><span class="line">//关闭文件</span><br><span class="line">fclose(fp);</span><br><span class="line">&#125;</span><br><span class="line">return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><p style="text-align:center;font-size:1.5rem">文中<strong>ToUnicode()</strong>及<strong>FromUnicode</strong>均为封装好的函数，详见<a href="http://www.jianshu.com/p/52b709163b26" target="_blank" rel="noopener">VC下字符编码转换</a></p>]]></content>
      
      <categories>
          
          <category> Qt </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Qt </tag>
            
            <tag> 对话框 </tag>
            
            <tag> 文件对话框 </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Qt-QLabe显示文字和图片</title>
      <link href="/Qt-QLabeshowtextandimages.html"/>
      <url>/Qt-QLabeshowtextandimages.html</url>
      <content type="html"><![CDATA[<p><a href="http://doc.qt.io/qt-5/qlabel.html" target="_blank" rel="noopener">QLabe Class参考文档</a></p><p><img src="http://upload-images.jianshu.io/upload_images/5804969-e44b6926fca028b0.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="示例图片.png"></p><blockquote><p>文字与图片的显示格式实际上是用<strong>Qt StyleSheet</strong>（样式表）设置的<br>与css样式中的差不多</p></blockquote><ul><li>对齐方式</li></ul><p><img src="http://upload-images.jianshu.io/upload_images/5804969-993d3520aaeb4965.PNG?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="对齐方式.PNG"></p><ul><li>是否换行</li></ul><p><img src="http://upload-images.jianshu.io/upload_images/5804969-aa49526c35f8a0bd.PNG?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="是否换行.PNG"></p><ul><li>设置边框</li></ul><p><img src="http://upload-images.jianshu.io/upload_images/5804969-0e54eafadb013e0d.PNG?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="边框.PNG"></p><blockquote><p>显示LOGO(显示图片)</p></blockquote><ul><li><p>添加图片资源<br><img src="http://upload-images.jianshu.io/upload_images/5804969-53f30ccc964e31d8.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="添加图片资源.png"></p></li><li><p>添加一个Labe用来显示图片</p></li></ul><p><img src="http://upload-images.jianshu.io/upload_images/5804969-2cce2fa18c90ff62.PNG?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="边框.PNG"></p><p><img src="http://upload-images.jianshu.io/upload_images/5804969-8fa48d881fabf796.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p><h2 id="❤️"><a href="#❤️" class="headerlink" title="❤️"></a><strong>❤️</strong></h2><p><img src="http://upload-images.jianshu.io/upload_images/5804969-64ca917b7b70f881.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1080/q/50" alt=""></p>]]></content>
      
      <categories>
          
          <category> Qt </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Qt </tag>
            
            <tag> QLabe </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Hello World</title>
      <link href="/hello-world.html"/>
      <url>/hello-world.html</url>
      <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/" target="_blank" rel="noopener">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html" target="_blank" rel="noopener">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues" target="_blank" rel="noopener">GitHub</a>.</p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">"My New Post"</span></span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html" target="_blank" rel="noopener">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html" target="_blank" rel="noopener">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html" target="_blank" rel="noopener">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/deployment.html" target="_blank" rel="noopener">Deployment</a></p><p><div id="disqus_thread"></div></p><script><ul><li>RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.</li><li>LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: <a href="https://disqus.com/admin/universalcode/#configuration-variables*/">https://disqus.com/admin/universalcode/#configuration-variables*/</a></li></ul><p>var disqus_config = function () {<br>this.page.url = PAGE_URL;  // Replace PAGE_URL with your page’s canonical URL variable<br>this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page’s unique identifier variable<br>};</p><p>(function() { // DON’T EDIT BELOW THIS LINE<br>var d = document, s = d.createElement(‘script’);<br>s.src = ‘<a href="https://nicebluechai.disqus.com/embed.js&#39;">https://nicebluechai.disqus.com/embed.js&#39;</a>;<br>s.setAttribute(‘data-timestamp’, +new Date());<br>(d.head || d.body).appendChild(s);<br>})();<br></script><p></p><p><noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" target="_blank" rel="noopener">comments powered by Disqus.</a></noscript><br>    <!--PC和WAP自适应版--></p><p><div id="SOHUCS" sid="请将此处替换为配置SourceID的语句"></div> </p><p><script type="text/javascript"><br>(function(){<br>var appid = ‘cytu1mJqc’;<br>var conf = ‘prod_724639f82a7493e5cc3377fc5c98c32b’;<br>var width = window.innerWidth || document.documentElement.clientWidth;<br>if (width &lt; 960) {<br>window.document.write(‘<script id="changyan_mobile_js" charset="utf-8" type="text/javascript" src="http://changyan.sohu.com/upload/mobile/wap-js/changyan_mobile.js?client_id=' + appid + '&conf=' + conf + '">&lt;\/script&gt;’); } else { var loadJs=function(d,a){var c=document.getElementsByTagName(“head”)[0]||document.head||document.documentElement;var b=document.createElement(“script”);b.setAttribute(“type”,”text/javascript”);b.setAttribute(“charset”,”UTF-8”);b.setAttribute(“src”,d);if(typeof a===”function”){if(window.attachEvent){b.onreadystatechange=function(){var e=b.readyState;if(e===”loaded”||e===”complete”){b.onreadystatechange=null;a()}}}else{b.onload=a}}c.appendChild(b)};loadJs(“<a href="http://changyan.sohu.com/upload/changyan.js&quot;,function(){window.changyan.api.config({appid:appid,conf:conf})})">http://changyan.sohu.com/upload/changyan.js&quot;,function(){window.changyan.api.config({appid:appid,conf:conf})})</a>; } })(); </script><br><blockquote><p>I love you forever</p></blockquote></p><blockquote><p>I love you forever 我爱你</p><footer><strong>pengloo53</strong><cite><a href="http://www.linux2me.com" target="_blank" rel="noopener">www.linux2me.com</a></cite></footer></blockquote><blockquote><p>I love you forever</p><footer><strong>David Levithan</strong><cite>Wide Awake</cite></footer></blockquote>]]></content>
      
      <categories>
          
          <category> 第一篇 </category>
          
          <category> Test </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 英文 </tag>
            
        </tags>
      
    </entry>
    
  
  
</search>
